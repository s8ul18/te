

    import pandas as pd
    import matplotlib.pyplot as plt

    df = pd.read_csv('Mall_Customers.csv')

    df
----------------------------------------------------------------------------
    #include 3rd and 4th column as x and y axis 
    x = df.iloc[:,3:]

    x

-------------------------------------------------------------------------------
    from sklearn.cluster import KMeans

    km = KMeans(n_clusters=6)

    x.shape

    #to see group created in array with similar number
    km.fit_predict(x)

------------------------------------------------------------------------------

    #To find Sum Squared Error (SSE) we find inertia
    km.inertia_

 -------------------------------------------------------------------------------

    #4] evaluate model
    #Elbow  Method for 15 k=clusters
    sse = []
    for k in range(1,16):
        km = KMeans(n_clusters=k)
        km.fit_predict(x)
        sse.append(km.inertia_)
-------------------------------------------------------------------------------
    #Ploting graph to identify Elbow point
    plt.title('Elbow Method')
    plt.xlabel('Value of K')
    plt.ylabel('SSE')
    plt.grid()
    plt.xticks(range(1,16))
    plt.plot(range(1,16), sse, marker='.',color='red')

-------------------------------------------------------------------------------------
    #Sillhoute Score Method
    from sklearn.metrics import silhouette_score
----------------------------------------------------------------------------------------
    silh = []
    # STARTS WITH 2 beacuse it compare distn with it's own and and neighbouring cluster
    for k in range (2,16):
        km = KMeans(n_clusters=k)
        labels = km.fit_predict(x)
        score = silhouette_score(x, labels)
        silh.append(score)
-------------------------------------------------------------------------------------------
    #Ploting bar that'll tell where does the highest value of silhouette score appeared
    plt.title('Silhoutte Method')
    plt.xlabel('Value of K')
    plt.grid()
    plt.xticks(range(2,16))
    plt.bar(range(2,16), silh, color='red')
------------------------------------------------------------------------------------------
 #THUS k=5 has max sillhoute score which means when 5 cluster are formed they will be ideal

    #3]Applying ML algorithm 
    # A]KMeans
    km = KMeans(n_clusters=5,random_state=0)

    labels = km.fit_predict(x)

    labels

-------------------------------------------------------------------------------------------------
    #Ploting the clustered data
    plt.figure(figsize=(16,9))
    plt.subplot(1,2,2)
    plt.title('KMeans')  
    plt.xlabel('Annual Income')
    plt.ylabel('Spending Score')
    plt.scatter(x['Annual Income (k$)'], x['Spending Score (1-100)'],c= labels)

------------------------------------------------------------------------------------------------

    from sklearn.cluster import AgglomerativeClustering

    #B]Hierarchial Clustering(Agglomerative)
    agl = AgglomerativeClustering(n_clusters=5)

    alabels = agl.fit_predict(x)

    alabels

---------------------------------------------------------------------------------------------------
    plt.figure(figsize=(16,9))
    plt.subplot(1,2,2)
    plt.title('Agglomerative (Hierarchical)')
    plt.xlabel('Annual Income')
    plt.ylabel('Spending Score')
    plt.scatter(x['Annual Income (k$)'], x['Spending Score (1-100)'], c= alabels)

 -----------------------------------------------------------------------------------------------
